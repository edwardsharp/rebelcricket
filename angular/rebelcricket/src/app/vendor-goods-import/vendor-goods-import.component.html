<md-accordion class="headers-align">
  <md-expansion-panel expanded="true" hideToggle="true">
    <md-expansion-panel-header>
      <md-panel-title>
        Google Spreadsheet
      </md-panel-title>
      <md-panel-description>
        Import vendor goods from a Google spreadsheet.
      </md-panel-description>
    </md-expansion-panel-header>

    <i *ngIf="loading">loadng...</i>

		<div class="center" *ngIf="!isSignedIn">
			<button md-button (click)="signIn()" title="Authorize">
			  <md-icon>account_circle</md-icon>
			  <span>Authorize with Google</span>
			</button>
		</div>

		<div *ngIf="isSignedIn">
			<div class="center" style="display:flex;align-items:center;">
				<md-form-field class="fullwidth">
				  <input mdInput [(ngModel)]="gsheetId" placeholder="Google Sheet ID">
				</md-form-field>
			</div>
			<div class="center" style="display:flex;align-items:baseline;">
				<md-select [placeholder]="gsheetIds.length > 0 ? 'Select Sheet' : 'loading sheets...'" [(ngModel)]="sheetId" class="halfwidth">
				  <md-option *ngFor="let sheet of gsheetIds" [value]="sheet.sheetId">
				    {{ sheet.title }}
				  </md-option>
				</md-select>

				<md-form-field class="halfwidth">
				  <input mdInput [(ngModel)]="gsheetRange" placeholder="Google Sheet Range">
				</md-form-field>
			</div>
			<div class="center" style="display:flex;align-items:baseline;">
				<md-select class="halfwidth" placeholder="Catalog" [(ngModel)]="catalog">
				  <md-option *ngFor="let item of catalogs" [value]="item">
				    {{ item.name }}
				  </md-option>
				</md-select>

				<md-checkbox class="halfwidth" [(ngModel)]="dropExistingItems">Drop existing items</md-checkbox>
			</div>
		</div>

		<pre *ngFor="let item of pre">
			{{item}}
		</pre>

    <md-action-row>
    	<button md-button (click)="getVendorGoodsFromGsheet(gsheetId)" [disabled]="sheetId == undefined">
			  <md-icon>import_export</md-icon> Import Vendor Goods
			</button>
    	<span class="flexfill"></span>
    	<span *ngIf="isSignedIn">
		  	<button md-icon-button [mdMenuTriggerFor]="acct">
			    <md-icon class="icon">more_vert</md-icon>
			  </button>
			  <md-menu #acct="mdMenu">
			    <button md-menu-item (click)="signOut()" title="Sign Out">
			      <md-icon>delete</md-icon>
			      <span>Google sign out</span>
			    </button>
			  </md-menu>
		  </span>
    </md-action-row>
  </md-expansion-panel>

<!--   <md-expansion-panel hideToggle="true">
    <md-expansion-panel-header>
      <md-panel-title>
        Title
      </md-panel-title>
      <md-panel-description>
        description
        <md-icon>icon</md-icon>
      </md-panel-description>
    </md-expansion-panel-header>

    <md-action-row>
    	
    </md-action-row>
  </md-expan sion-panel> -->


</md-accordion>
