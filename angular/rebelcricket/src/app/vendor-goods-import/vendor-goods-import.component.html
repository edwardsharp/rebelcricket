<md-accordion class="headers-align">
  <md-expansion-panel expanded="true" hideToggle="true">
    <md-expansion-panel-header>
      <md-panel-title>
        Google Spreadsheet
      </md-panel-title>
      <md-panel-description>
        Import vendor goods from a Google spreadsheet.
      </md-panel-description>
    </md-expansion-panel-header>

    <i *ngIf="loading">loadng...</i>

    <div *ngIf="!loading && needsCredentials">
    	<p>Please add an API key &amp; Client ID to your <a routerLink="/dashboard/settings">Google settings</a> to import vendor goods from a spreadsheet.</p> 
    </div>

		<div class="center" *ngIf="!isSignedIn && !needsCredentials">
			<button md-button (click)="signIn()" title="Authorize">
			  <md-icon>account_circle</md-icon>
			  <span>Authorize with Google</span>
			</button>
		</div>

		<div *ngIf="isSignedIn">

			<div class="center" style="display:flex;align-items:center;">
				<md-form-field class="fullwidth">
				  <input mdInput [(ngModel)]="gsheetId" placeholder="Google Sheet ID">
				</md-form-field>
			</div>
			<div class="center" style="display:flex;align-items:baseline;">
				<md-select [placeholder]="gsheetIds.length > 0 ? 'Select Sheet' : 'loading sheets...'" [(ngModel)]="sheetId" class="halfwidth">
				  <md-option *ngFor="let sheet of gsheetIds" [value]="sheet.sheetId">
				    {{ sheet.title }}
				  </md-option>
				</md-select>

				<md-form-field class="halfwidth">
				  <input mdInput [(ngModel)]="gsheetRange" placeholder="Google Sheet Range">
				</md-form-field>
			</div>
			<div class="center" style="display:flex;align-items:baseline;">
				
				<md-form-field class="halfwidth">
				  <input mdInput [(ngModel)]="catalog" [formControl]="catalogFormControl" placeholder="Catalog">
				  <md-error *ngIf="catalogFormControl.hasError('pattern')">
			      Only letters. No spaces or special characters. 
			    </md-error>
			    <md-error *ngIf="catalogFormControl.hasError('required')">
			      Catalog is <strong>required</strong>
			    </md-error>
				</md-form-field>


			</div>
		</div>

		<dl *ngFor="let item of pre">
			<dd>{{item}}</dd>
		</dl>

    <md-action-row>
    	<button *ngIf="!needsCredentials" md-button (click)="getVendorGoodsFromGsheet(gsheetId)" [disabled]="sheetId == undefined">
			  <md-icon>import_export</md-icon> Import Vendor Goods
			</button>
    	<span class="flexfill"></span>
    	<span *ngIf="isSignedIn">
		  	<button md-icon-button [mdMenuTriggerFor]="acct">
			    <md-icon class="icon">more_vert</md-icon>
			  </button>
			  <md-menu #acct="mdMenu">
			    <button md-menu-item (click)="signOut()" title="Sign Out">
			      <md-icon>account_circle</md-icon>
			      <span>Google sign out</span>
			    </button>

			    <button md-menu-item (click)="dropExistingVendorGoods()" title="Delete All Vendor Goods">
			      <md-icon>delete</md-icon>
			      <span>Delete <b>ALL</b> Vendor Goods</span>
			    </button>
			    
			  </md-menu>
		  </span>
    </md-action-row>
  </md-expansion-panel>

<!--   <md-expansion-panel hideToggle="true">
    <md-expansion-panel-header>
      <md-panel-title>
        Title
      </md-panel-title>
      <md-panel-description>
        description
        <md-icon>icon</md-icon>
      </md-panel-description>
    </md-expansion-panel-header>

    <md-action-row>
    	
    </md-action-row>
  </md-expan sion-panel> -->


</md-accordion>
