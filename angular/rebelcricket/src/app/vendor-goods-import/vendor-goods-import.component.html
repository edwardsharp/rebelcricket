<mat-accordion class="headers-align">
  <mat-expansion-panel expanded="true" hideToggle="true">
    <mat-expansion-panel-header>
      <mat-panel-title>
        Google Spreadsheet
      </mat-panel-title>
      <mat-panel-description>
        Import vendor goods from a Google spreadsheet.
      </mat-panel-description>
    </mat-expansion-panel-header>

    <i *ngIf="loading">loadng...</i>

    <div *ngIf="!loading && needsCredentials">
    	<p>Please add an API key &amp; Client ID to your <a routerLink="/dashboard/settings">Google settings</a> to import vendor goods from a spreadsheet.</p> 
    </div>

		<div class="center" *ngIf="!isSignedIn && !needsCredentials">
			<button mat-button (click)="signIn()" title="Authorize">
			  <mat-icon>account_circle</mat-icon>
			  <span>Authorize with Google</span>
			</button>
		</div>

		<div *ngIf="isSignedIn">

			<div class="center" style="display:flex;align-items:center;">
				<mat-form-field class="fullwidth">
				  <input matInput [(ngModel)]="gsheetId" placeholder="Google Sheet ID">
				</mat-form-field>
			</div>
			<div class="center" style="display:flex;align-items:baseline;">
				<mat-select [placeholder]="gsheetIds.length > 0 ? 'Select Sheet' : 'loading sheets...'" [(ngModel)]="sheetId" class="halfwidth">
				  <mat-option *ngFor="let sheet of gsheetIds" [value]="sheet.sheetId">
				    {{ sheet.title }}
				  </mat-option>
				</mat-select>

				<mat-form-field class="halfwidth">
				  <input matInput [(ngModel)]="gsheetRange" placeholder="Google Sheet Range">
				</mat-form-field>
			</div>
			<div class="center" style="display:flex;align-items:baseline;">
				
				<mat-form-field class="halfwidth">
				  <input matInput [(ngModel)]="catalog" [formControl]="catalogFormControl" placeholder="Catalog">
				  <mat-error *ngIf="catalogFormControl.hasError('pattern')">
			      Only letters. No spaces or special characters. 
			    </mat-error>
			    <mat-error *ngIf="catalogFormControl.hasError('required')">
			      Catalog is <strong>required</strong>
			    </mat-error>
				</mat-form-field>


			</div>
		</div>

		<dl *ngFor="let item of pre">
			<dd>{{item}}</dd>
		</dl>

    <mat-action-row>
    	<button *ngIf="!needsCredentials" mat-button (click)="getVendorGoodsFromGsheet(gsheetId)" [disabled]="sheetId == undefined">
			  <mat-icon>import_export</mat-icon> Import Vendor Goods
			</button>
    	<span class="flexfill"></span>
    	<span *ngIf="isSignedIn">
		  	<button mat-icon-button [matMenuTriggerFor]="acct">
			    <mat-icon class="icon">more_vert</mat-icon>
			  </button>
			  <mat-menu #acct="matMenu">
			    <button mat-menu-item (click)="signOut()" title="Sign Out">
			      <mat-icon>account_circle</mat-icon>
			      <span>Google sign out</span>
			    </button>

			    <button mat-menu-item (click)="dropExistingVendorGoods()" title="Delete All Vendor Goods">
			      <mat-icon>delete</mat-icon>
			      <span>Delete <b>ALL</b> Vendor Goods</span>
			    </button>
			    
			  </mat-menu>
		  </span>
    </mat-action-row>
  </mat-expansion-panel>

<!--   <mat-expansion-panel hideToggle="true">
    <mat-expansion-panel-header>
      <mat-panel-title>
        Title
      </mat-panel-title>
      <mat-panel-description>
        description
        <mat-icon>icon</mat-icon>
      </mat-panel-description>
    </mat-expansion-panel-header>

    <mat-action-row>
    	
    </mat-action-row>
  </mat-expan sion-panel> -->


</mat-accordion>
