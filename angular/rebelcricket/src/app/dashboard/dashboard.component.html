<div dnd-sortable-container 
  id="container"
  [sortableData]="containers" 
  [dropZones]="['container-dropZone']">
  <div *ngFor="let container of containers; let i = index" dnd-sortable [sortableIndex]="i" 
    [dragEnabled]="dragOperation"
    (onDropSuccess)="containerDropped(i, container)"
    [@containerState]="container.collapsed">
    <md-toolbar [@containerHeadingState]="container.collapsed" color="secondary">
<!--       <button md-icon-button 
        (mousedown)="dragOperation=true;" 
        (mouseup)="dragOperation=false;" 
        (mouseout)="dragOperation=false;"
        tabindex="-1"
        class="drag-handle">
        <md-icon>drag_handle</md-icon>
      </button> -->
      <button md-icon-button 
        tabindex="-1"
        [@containerButtonState]="container.collapsed"
        (click)="container.toggleCollapse()">
        <md-icon>chevron_left</md-icon>
      </button>
      <h1>{{container.name}} (2)</h1>
      <button *ngIf="container.collapsed === 'active'"
        md-icon-button 
        tabindex="-1">
        <md-icon>filter_list</md-icon>
      </button>
    </md-toolbar>
    <div *ngIf="container.collapsed === 'active'"
      dnd-sortable-container
      class="status-container" 
      [sortableData]="container.widgets" 
      [dropZones]="['widget-dropZone']">
      <md-card dnd-sortable
        class="mat-elevation-z0" 
        *ngFor="let widget of container.widgets; let x = index" 
        [sortableIndex]="x" 
        [dragEnabled]="!dragOperation" 
        [dragData]="widget"
        (onDropSuccess)="cardDropped($event, widget, container)">
        <md-card-header dnd-sortable-handle>
          <!-- <div md-card-avatar class="example-header-image">
            &nbsp;
          </div> -->

          <md-card-title>#{{widget.name}}</md-card-title>
          <md-card-subtitle>{{container.id}} {{container.name}}</md-card-subtitle>
        </md-card-header>
        <!-- <img md-card-image src="assets/img/examples/shiba2.jpg" alt="Photo of a Shiba Inu"> -->
        <md-card-content>

          <md-expansion-panel class="mat-elevation-z0">
            <md-expansion-panel-header>
              Description 
            </md-expansion-panel-header>

            <p>
            Loremipsumdolorsitamet,consecteturadipiscingelit.Fusceliberorisus,hendreritsitametarcuac,tempuscommodomauris.Proinplacerateratetmassainterdum,inpulvinarmagnafermentum.Sednuncsapien,ultricesvitaevehiculasitamet,aliquetinnisi.Praesentrutrumquislacusatmollis.Vestibulumnuncvelit,imperdietsedurnasitamet,ornareimperdietnulla.Etiamquissuscipitleo,eutemporipsum.Etiamutcursusnulla. Aliquam sagittis lorem non accumsan hendrerit. Etiam varius non tellus vel pretium. Integer rhoncus malesuada ex auctor finibus. Nulla erat ligula, feugiat ac est laoreet, pulvinar tincidunt nulla. Maecenas cursus pharetra nibh et elementum.
            </p>
            

            <!-- <md-action-row>
              <span clas="flexfill"></span>
              
            </md-action-row> -->
          </md-expansion-panel>

          
        </md-card-content>
        <md-card-actions>
          <md-icon>schedule</md-icon>
          <small>12h</small>
          <span class="flexfill"></span>
          <button md-icon-button mdTooltip="Edit" mdTooltipPosition="above"><md-icon>edit</md-icon></button>
          <button md-icon-button [mdMenuTriggerFor]="cardMenu">
            <md-icon class="icon">more_vert</md-icon>
          </button>
          <md-menu #cardMenu="mdMenu">
            <button md-menu-item [mdMenuTriggerFor]="status" title="Status">
              <md-icon>inbox</md-icon>
              <span>Status</span>
            </button>
            <button md-menu-item title="Move Up">
              <md-icon>arrow_upward</md-icon>
              <span>Move Up</span>
            </button>
            <button md-menu-item title="Move Down">
              <md-icon>arrow_downward</md-icon>
              <span>Move Down</span>
            </button>
            <hr>
            <button md-menu-item title="Delete">
              <md-icon>delete</md-icon>
              <span>Delete</span>
            </button>
          </md-menu>

          <md-menu #status="mdMenu">
            <button md-menu-item *ngFor="let item of settings.order_statuses">
              {{item.name}}
            </button>
          </md-menu>

        </md-card-actions>
      </md-card>
    </div>
  </div>
</div>
