<mat-accordion id="settings" class="headers-align" *ngIf="settings">
  
  <mat-expansion-panel >
    <mat-expansion-panel-header>
      <mat-panel-title>
        General
      </mat-panel-title>
      <mat-panel-description>
        Site information &amp; landing page details
      </mat-panel-description>
    </mat-expansion-panel-header>

    <mat-form-field class="halfwidth">
      <input matInput 
        [(ngModel)]="settings.site_title" 
        (change)="onChange()"
        placeholder="Site Title">
    </mat-form-field>
    <mat-form-field class="halfwidth">
      <input matInput 
        [(ngModel)]="settings.logo_image" 
        (change)="onChange()"
        placeholder="Site Logo URL">
    </mat-form-field>

    <mat-form-field class="fullwidth">
      <textarea matInput 
        [(ngModel)]="settings.site_description" 
        (change)="onChange()"
        placeholder="Site Description"></textarea>
    </mat-form-field>

    <mat-form-field class="fullwidth">
      <input matInput 
        [(ngModel)]="settings.phone" 
        (change)="onChange()"
        placeholder="Phone #">
    </mat-form-field>

    <div>
      <div *ngIf="settings?.landing_page_social_items.length == 0; else elseBlock" class="center">
        <h3>No landing page social media linkz yet...</h3>
      </div>
      <ng-template #elseBlock><h4>Social Media Linkz</h4></ng-template>
      
      <div class="detail-item" *ngFor="let item of settings.landing_page_social_items">
        <mat-form-field class="detail-item-heading halfwidthbtn">
          <input matInput 
            [(ngModel)]="item.url" 
            (change)="onChange()"
            placeholder="URL">
        </mat-form-field>
        <mat-form-field class="halfwidthbtn">
          <input matInput 
            [(ngModel)]="item.name" 
            (change)="onChange()"
            placeholder="Name (optional)">
        </mat-form-field>
        <button mat-icon-button 
          (click)="removeLandingSocialItem(item)" 
          matTooltip="Delete {{item.name}}"
          class="delete-service">
          <mat-icon>delete</mat-icon>
        </button>
      </div>
    </div>

    <div>
      <div *ngIf="settings?.landing_page_items.length == 0; else landingElseBlock" class="center">
        <h3>No landing page carousel images yet...</h3>
      </div>
      <ng-template #landingElseBlock><h4>Carousel Images</h4></ng-template>
      
      <div class="detail-item" *ngFor="let item of settings.landing_page_items">
        <mat-form-field class="detail-item-heading halfwidthbtn">
          <input matInput 
            [(ngModel)]="item.url" 
            (change)="onChange()"
            placeholder="Image URL">
        </mat-form-field>
        <mat-form-field class="halfwidthbtn">
          <input matInput 
            [(ngModel)]="item.href" 
            (change)="onChange()"
            placeholder="Image Link (optional)">
        </mat-form-field>
        <button mat-icon-button 
          (click)="removeLandingPageItem(item)" 
          matTooltip="Delete Image"
          class="delete-service">
          <mat-icon>delete</mat-icon>
        </button>
      </div>
        
    </div>

    <mat-action-row>
      
      <button mat-button 
        (click)="addLandingSocialItem()" 
        matTooltip="Add a new social media link">
        <mat-icon>add</mat-icon> SocialMedia Link
      </button>

      <button mat-button 
        (click)="addLandingPageItem()" 
        matTooltip="Add a new landing page image">
        <mat-icon>add</mat-icon> Carousel Image
      </button>

      <span class="flexfill"></span>
      <button type="button" mat-button (click)="saveSettings()" [disabled]="disableSave">
        <mat-icon>save</mat-icon>Save Settings
      </button>
    </mat-action-row>
  </mat-expansion-panel>

  <mat-expansion-panel>
    <mat-expansion-panel-header>
      <mat-panel-title>
        About
      </mat-panel-title>
      <mat-panel-description>
        About page details
      </mat-panel-description>
    </mat-expansion-panel-header>

    <mat-form-field class="halfwidth">
      <input matInput 
        [(ngModel)]="settings.about_page_heading" 
        (change)="onChange()"
        placeholder="About Page Heading">
    </mat-form-field>
    <div>
      <div *ngIf="settings?.about_page_items.length == 0" class="center">
        <h3>No details yet...</h3>
      </div>

      <div class="detail-item" *ngFor="let item of settings.about_page_items">
        <mat-form-field class="detail-item-heading">
          <input matInput 
            [(ngModel)]="item.heading" 
            (change)="onChange()"
            placeholder="Item Heading Text">
        </mat-form-field>
        <button mat-icon-button 
          (click)="removeAboutPageItem(item)" 
          matTooltip="Delete {{item.heading}}"
          class="delete-service">
          <mat-icon>delete</mat-icon>
        </button>
        <div>
          <mat-form-field class="fullwidth">
            <textarea matInput 
              [(ngModel)]="item.detail" 
              (change)="onChange()"
              placeholder="Item Detail Text"></textarea>
          </mat-form-field>
        </div>
      </div>
        
    </div>

    <mat-action-row>
      
      <button mat-button 
        (click)="addAboutPageItem()" 
        matTooltip="Add a new detail item">
        <mat-icon>add</mat-icon> Detail Item
      </button>

      <span class="flexfill"></span>
      <button type="button" mat-button (click)="saveSettings()" [disabled]="disableSave">
        <mat-icon>save</mat-icon>Save Settings
      </button>
    </mat-action-row>
  </mat-expansion-panel>

  <mat-expansion-panel *ngIf="settings?.services">
    <mat-expansion-panel-header>
      <mat-panel-title>
        Services
      </mat-panel-title>
      <mat-panel-description>
        Service page details
      </mat-panel-description>
    </mat-expansion-panel-header>

    <div class="edit-services-row">
      <mat-select placeholder="Edit Service" [(ngModel)]="selectedService" name="service">
        <mat-option *ngFor="let service of settings.services" [value]="service">
          {{service.name}}
        </mat-option>
      </mat-select>
      <button mat-icon-button 
        *ngIf="selectedService"
        (click)="removeService(selectedService)" 
        matTooltip="Delete {{selectedService.name}}"
        class="delete-service">
        <mat-icon>delete</mat-icon>
      </button>
      <span class="flexfill"></span>
      <mat-form-field class="halfwidth">
        <input matInput 
          [(ngModel)]="settings.service_heading" 
          (change)="onChange()"
          placeholder="Services Page Heading">
      </mat-form-field>
      
    </div>
    <div>
      <div *ngIf="settings?.services.length == 0" class="center">
        <h3>No services yet...</h3>
      </div>

      <div *ngIf="selectedService" class="service-panel">
        
        <div>
          <mat-form-field class="halfwidth">
            <input matInput 
              [(ngModel)]="selectedService.name" 
              (change)="onChange()"
              placeholder="Name">
          </mat-form-field>
          <mat-form-field class="halfwidth">
            <input matInput 
              [(ngModel)]="selectedService.slug" 
              (change)="onChange()"
              placeholder="Slug">
          </mat-form-field>
        </div>

        <mat-form-field class="fullwidth">
          <input matInput 
            [(ngModel)]="selectedService.image" 
            (change)="onChange()"
            placeholder="Main Image URL">
        </mat-form-field>
        <div class="detail-item">
          <div *ngFor="let detail_image of selectedService.detail_images">
            <mat-form-field class="halfwidth">
              <input matInput 
                [(ngModel)]="detail_image.url" 
                (change)="onChange()"
                placeholder="Detail Image URL">
            </mat-form-field>
            <button mat-icon-button 
              (click)="removeServiceDetailImage(detail_image)" 
              matTooltip="Delete {{detail_image.url}}"
              class="delete-service">
              <mat-icon>delete</mat-icon>
            </button>
          </div>
        </div>


        <div class="detail-item">
          <div *ngFor="let item of selectedService.detail_items">
            <mat-form-field class="detail-item-heading">
              <input matInput 
                [(ngModel)]="item.heading" 
                (change)="onChange()"
                placeholder="Item Heading Text">
            </mat-form-field>
            <button mat-icon-button 
              (click)="removeServiceDetailItem(item)" 
              matTooltip="Delete {{item.heading}}"
              class="delete-service">
              <mat-icon>delete</mat-icon>
            </button>
            <div>
              <mat-form-field class="fullwidth">
                <textarea matInput 
                  [(ngModel)]="item.detail" 
                  (change)="onChange()"
                  placeholder="Item Detail Text"></textarea>
              </mat-form-field>
            </div>
          </div>
        </div>

      </div>

    </div>

    <mat-action-row>
      
      <button mat-button 
        (click)="addService()" 
        matTooltip="Add a new service">
        <mat-icon>add</mat-icon> Service
      </button>

      <button mat-button 
        *ngIf="selectedService"
        (click)="addServiceDetailImage()" 
        matTooltip="Add a new detail image">
        <mat-icon>add</mat-icon> Detail Image
      </button>

      <button mat-button 
        *ngIf="selectedService"
        (click)="addServiceDetailItem()" 
        matTooltip="Add a new detail item">
        <mat-icon>add</mat-icon> Detail Item
      </button>

      <span class="flexfill"></span>
      <button type="button" mat-button (click)="saveSettings()" [disabled]="disableSave">
        <mat-icon>save</mat-icon>Save Settings
      </button>
    </mat-action-row>
  </mat-expansion-panel>

  <mat-expansion-panel *ngIf="settings?.services">
    <mat-expansion-panel-header>
      <mat-panel-title>
        Orders
      </mat-panel-title>
      <mat-panel-description>
        Order form details
      </mat-panel-description>
    </mat-expansion-panel-header>

    <!-- #TODO: setup array of top-level order fields, and grouping thing
         things like: estimate_number
invoice_number
purchase_order_number
in_hands_date
job_name
from_po
art_notes
printers_notes
call_when_complete
will_call
ship_via
ship_via_txt
ship_to
     -->

    <div class="edit-services-row">
      <mat-select placeholder="Edit Service" [(ngModel)]="selectedService" name="service">
        <mat-option *ngFor="let service of settings.services" [value]="service">
          {{service.name}}
        </mat-option>
      </mat-select>
      <button mat-icon-button 
        *ngIf="selectedService"
        (click)="removeService(selectedService)" 
        matTooltip="Delete {{selectedService.name}}"
        class="delete-service">
        <mat-icon>delete</mat-icon>
      </button>

      <span class="flexfill"></span>
      <mat-form-field *ngIf="selectedService">
        <input matInput 
          [(ngModel)]="selectedService.name" 
          (change)="onChange()"
          placeholder="Name">
      </mat-form-field>
      <span class="flexfill"></span>
      <mat-select placeholder="Catalog" 
        *ngIf="selectedService"
        [(ngModel)]="selectedService.vendor_goods_catalog"
        (change)="onChange()">
        <mat-option value="">
          None
        </mat-option>
        <mat-option value="default">
          Default
        </mat-option>
      </mat-select>
      <mat-checkbox *ngIf="selectedService" 
        [(ngModel)]="selectedService.notes" (change)="onChange()">Notes</mat-checkbox>
    </div>
    <div *ngIf="settings?.services.length == 0" class="center">
      <h3>No services yet...</h3>
    </div>
    <div *ngIf="selectedService" class="service-panel">
      <h3 *ngIf="selectedService.order_fields && selectedService.order_fields.length > 0">Order Fields:</h3>
      <div class="detail-item">
        <div *ngFor="let field of selectedService.order_fields">
          <section>
            <button mat-icon-button 
              (click)="removeOrderField(field)" 
              matTooltip="Delete Order Service Item"
              class="delete-service">
              <mat-icon>delete</mat-icon>
            </button>
            <mat-form-field>
              <input matInput 
                [(ngModel)]="field.name" 
                (change)="onChange()"
                placeholder="Order Field Name">
            </mat-form-field>

            <mat-checkbox [(ngModel)]="field.internal" (change)="onChange()">Internal</mat-checkbox>
            <mat-checkbox [(ngModel)]="field.required" (change)="onChange()">Required</mat-checkbox>

          </section>
          <section>
            <mat-select placeholder="Type" [(ngModel)]="field.type" (change)="onChange()">
              <mat-option *ngFor="let type of order_field_types" [value]="type.value">
                {{ type.name }}
              </mat-option>
            </mat-select>
            <button mat-button 
              *ngIf="field.type == SelectFieldType"
              (click)="addOrderFieldSelectItem(field)" 
              matTooltip="Add a Select field option">
              <mat-icon>add</mat-icon> Select Option
            </button>
          </section>
          <div *ngIf="field.type == SelectFieldType">
            <section *ngFor="let select_item of field.select_items">
              <mat-form-field>
                <input matInput 
                  [(ngModel)]="select_item.name" 
                  (change)="onChange()"
                  placeholder="Option Value">
              </mat-form-field>
              <button mat-icon-button 
                (click)="removeOrderFieldSelectItem(field,select_item)" 
                matTooltip="Delete Select Item"
                class="delete-service">
                <mat-icon>delete</mat-icon>
              </button>
            </section>
          </div>
          <hr>
        </div>
      </div>

    </div>


    <mat-action-row>
      
      <button mat-button 
        (click)="addService()" 
        matTooltip="Add a new service">
        <mat-icon>add</mat-icon> Service
      </button>

      <button mat-button 
        *ngIf="selectedService"
        (click)="addOrderField()" 
        matTooltip="Add a new order field">
        <mat-icon>add</mat-icon> Field
      </button>

      <span class="flexfill"></span>
      <button type="button" mat-button (click)="saveSettings()" [disabled]="disableSave">
        <mat-icon>save</mat-icon>Save Settings
      </button>
    </mat-action-row>
  </mat-expansion-panel>


  <mat-expansion-panel>
    <mat-expansion-panel-header>
      <mat-panel-title>
        Dashboard
      </mat-panel-title>
      <mat-panel-description>
        Order category lanes
      </mat-panel-description>
    </mat-expansion-panel-header>

    <div *ngIf="settings?.order_statuses">
	   	<h3>Order Statuses</h3>
	    <mat-chip-list matPrefix #chipList> 
	      <mat-chip *ngFor="let item of settings.order_statuses" [selectable]="selectable"
	               [removable]="removable" (remove)="removeStatus(item)">
	        <mat-icon matChipRemove *ngIf="removable">cancel</mat-icon>
	        {{item.name}}
	      </mat-chip>
	    </mat-chip-list>
	    <mat-form-field class="demo-chip-list fullwidth">
	      <input matInput placeholder="New status..."
	             [matChipInputFor]="chipList"
	             [matChipInputSeparatorKeyCodes]="separatorKeysCodes"
	             [matChipInputAddOnBlur]="addOnBlur"
	             (matChipInputTokenEnd)="addStatus($event)" />
	    </mat-form-field>

		</div>


    <mat-action-row>
    	<button type="button" mat-button (click)="saveSettings()" [disabled]="disableSave">
    		<mat-icon>save</mat-icon>Save Settings
    	</button>
    </mat-action-row>
  </mat-expansion-panel>


  <mat-expansion-panel *ngIf="settings?.google_api">
    <mat-expansion-panel-header>
      <mat-panel-title>
        Google
      </mat-panel-title>
      <mat-panel-description>
        API keys for Google services
      </mat-panel-description>
    </mat-expansion-panel-header>

    <div>
      <mat-form-field class="halfwidth">
        <input matInput 
          [(ngModel)]="settings.google_api.client_id" 
          (change)="onChange()"
          placeholder="Client ID">
      </mat-form-field>
      <mat-form-field class="halfwidth">
        <input matInput 
          [(ngModel)]="settings.google_api.api_key" 
          (change)="onChange()"
          placeholder="API Key">
      </mat-form-field>
    </div>

    <mat-action-row>
      <button type="button" mat-button (click)="saveSettings()" [disabled]="disableSave">
        <mat-icon>save</mat-icon>Save Settings
      </button>
    </mat-action-row>
  </mat-expansion-panel>

</mat-accordion>
