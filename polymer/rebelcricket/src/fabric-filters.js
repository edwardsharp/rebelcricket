var initFabricFilters=function(e){function n(e,n){var t=c.getActiveObject();t.filters[e]=n,t.applyFilters(c.renderAll.bind(c))}function t(e,n,t){var i=c.getActiveObject();i.filters[e]&&(i.filters[e][n]=t,i.applyFilters(c.renderAll.bind(c)))}fabric.Object.prototype.transparentCorners=!1,fabric.Object.prototype.padding=5,fabric.Object.prototype.transparentCorners=!1;var c=this.__canvas=e.canvas,i=fabric.Image.filters;c.on({"object:selected":function(){for(var n=["grayscale","invert","remove-white","sepia","sepia2","brightness","contrast","saturate","noise","gradient-transparency","pixelate","blur","sharpen","emboss","tint","multiply","blend"],t=0;t<n.length;t++)e.$$("#"+n[t]).checked=!!c.getActiveObject().filters[t]}});e.$$("#grayscale").onclick=function(){n(0,this.checked&&new i.Grayscale)},e.$$("#invert").onclick=function(){n(1,this.checked&&new i.Invert)},e.$$("#remove-white").onclick=function(){n(2,this.checked&&new i.RemoveWhite({threshold:e.$$("#remove-white-threshold").value,distance:e.$$("#remove-white-distance").value}))},e.$$("#remove-white-threshold").onchange=function(){t(2,"threshold",this.value)},e.$$("#remove-white-distance").onchange=function(){t(2,"distance",this.value)},e.$$("#sepia").onclick=function(){n(3,this.checked&&new i.Sepia)},e.$$("#sepia2").onclick=function(){n(4,this.checked&&new i.Sepia2)},e.$$("#brightness").onclick=function(){n(5,this.checked&&new i.Brightness({brightness:parseInt(e.$$("#brightness-value").value,10)}))},e.$$("#brightness-value").onchange=function(){t(5,"brightness",parseInt(this.value,10))},e.$$("#contrast").onclick=function(){n(6,this.checked&&new i.Contrast({contrast:parseInt(e.$$("#contrast-value").value,10)}))},e.$$("#contrast-value").onchange=function(){t(6,"contrast",parseInt(this.value,10))},e.$$("#saturate").onclick=function(){n(7,this.checked&&new i.Saturate({saturate:parseInt(e.$$("#saturate-value").value,10)}))},e.$$("#saturate-value").onchange=function(){t(7,"saturate",parseInt(this.value,10))},e.$$("#noise").onclick=function(){n(8,this.checked&&new i.Noise({noise:parseInt(e.$$("#noise-value").value,10)}))},e.$$("#noise-value").onchange=function(){t(8,"noise",parseInt(this.value,10))},e.$$("#gradient-transparency").onclick=function(){n(9,this.checked&&new i.GradientTransparency({threshold:parseInt(e.$$("#gradient-transparency-value").value,10)}))},e.$$("#gradient-transparency-value").onchange=function(){t(9,"threshold",parseInt(this.value,10))},e.$$("#pixelate").onclick=function(){n(10,this.checked&&new i.Pixelate({blocksize:parseInt(e.$$("#pixelate-value").value,10)}))},e.$$("#pixelate-value").onchange=function(){t(10,"blocksize",parseInt(this.value,10))},e.$$("#blur").onclick=function(){n(11,this.checked&&new i.Convolute({matrix:[1/9,1/9,1/9,1/9,1/9,1/9,1/9,1/9,1/9]}))},e.$$("#sharpen").onclick=function(){n(12,this.checked&&new i.Convolute({matrix:[0,-1,0,-1,5,-1,0,-1,0]}))},e.$$("#emboss").onclick=function(){n(13,this.checked&&new i.Convolute({matrix:[1,1,1,1,.7,-1,-1,-1,-1]}))},e.$$("#tint").onclick=function(){n(14,this.checked&&new i.Tint({color:e.$$("#tint-color").value,opacity:parseFloat(e.$$("#tint-opacity").value)}))},e.$$("#tint-color").onchange=function(){t(14,"color",this.value)},e.$$("#tint-opacity").onchange=function(){t(14,"opacity",parseFloat(this.value))},e.$$("#multiply").onclick=function(){n(15,this.checked&&new i.Multiply({color:e.$$("#multiply-color").value}))},e.$$("#multiply-color").onchange=function(){t(15,"color",this.value)},e.$$("#blend").onclick=function(){n(16,this.checked&&new i.Blend({color:e.$$("#blend-color").value,mode:e.$$("#blend-mode").value}))},e.$$("#blend-mode").onchange=function(){t(16,"mode",this.value)},e.$$("#blend-color").onchange=function(){t(16,"color",this.value)}};