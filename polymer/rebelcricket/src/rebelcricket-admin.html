<link rel="import" href="../bower_components/polymer/polymer.html">
<link rel="import" href="../bower_components/app-layout/app-layout.html">
<link rel="import" href="../bower_components/app-layout/app-toolbar/app-toolbar.html">
<link rel="import" href="../bower_components/app-layout/app-header/app-header.html">
<link rel="import" href="../bower_components/app-layout/app-scroll-effects/effects/waterfall.html">
<link rel="import" href="../bower_components/app-layout/app-drawer/app-drawer.html">
<link rel="import" href="../bower_components/paper-button/paper-button.html">
<link rel="import" href="../bower_components/paper-icon-button/paper-icon-button.html">
<link rel="import" href="../bower_components/paper-fab/paper-fab.html">
<link rel="import" href="../bower_components/iron-ajax/iron-ajax.html">
<link rel="import" href="../bower_components/app-pouchdb/pouchdb.html">
<link rel="import" href="../bower_components/app-pouchdb/app-pouchdb-document.html">
<link rel="import" href="../bower_components/paper-input/paper-input.html">
<link rel="import" href="../bower_components/paper-input/paper-textarea.html">
<link rel="import" href="../bower_components/paper-spinner/paper-spinner.html">

<link rel="import" href="shared-styles.html">
<script src="../bower_components/jsoneditor/dist/jsoneditor.min.js"></script>


<dom-module id="rebelcricket-admin">

  <template>

    <style is="custom-style" include="shared-styles">

      div.jsoneditor,div.jsoneditor-outer{-moz-box-sizing:border-box;-webkit-box-sizing:border-box}div.jsoneditor input{height:auto;border:inherit}div.jsoneditor input:focus{border:none!important;box-shadow:none!important}div.jsoneditor table{border-collapse:collapse;width:auto}div.jsoneditor td,div.jsoneditor th{padding:0;display:table-cell;text-align:left;vertical-align:inherit;border-radius:inherit}div.jsoneditor-field,div.jsoneditor-readonly,div.jsoneditor-value{border:1px solid transparent;min-height:16px;min-width:32px;padding:2px;margin:1px;word-wrap:break-word;float:left}div.jsoneditor-field p,div.jsoneditor-value p{margin:0}div.jsoneditor-value{word-break:break-word}div.jsoneditor-readonly{min-width:16px;color:gray}div.jsoneditor-empty{border-color:#d3d3d3;border-style:dashed;border-radius:2px}div.jsoneditor-field.jsoneditor-empty::after,div.jsoneditor-value.jsoneditor-empty::after{pointer-events:none;color:#d3d3d3;font-size:8pt}div.jsoneditor-field.jsoneditor-empty::after{content:"field"}div.jsoneditor-value.jsoneditor-empty::after{content:"value"}a.jsoneditor-value.jsoneditor-url,div.jsoneditor-value.jsoneditor-url{color:green;text-decoration:underline}a.jsoneditor-value.jsoneditor-url{display:inline-block;padding:2px;margin:2px}a.jsoneditor-value.jsoneditor-url:focus,a.jsoneditor-value.jsoneditor-url:hover{color:#ee422e}div.jsoneditor td.jsoneditor-separator{padding:3px 0;vertical-align:top;color:gray}div.jsoneditor-field.jsoneditor-highlight,div.jsoneditor-field[contenteditable=true]:focus,div.jsoneditor-field[contenteditable=true]:hover,div.jsoneditor-value.jsoneditor-highlight,div.jsoneditor-value[contenteditable=true]:focus,div.jsoneditor-value[contenteditable=true]:hover{background-color:#FFFFAB;border:1px solid #ff0;border-radius:2px}div.jsoneditor-field.jsoneditor-highlight-active,div.jsoneditor-field.jsoneditor-highlight-active:focus,div.jsoneditor-field.jsoneditor-highlight-active:hover,div.jsoneditor-value.jsoneditor-highlight-active,div.jsoneditor-value.jsoneditor-highlight-active:focus,div.jsoneditor-value.jsoneditor-highlight-active:hover{background-color:#fe0;border:1px solid #ffc700;border-radius:2px}div.jsoneditor-value.jsoneditor-string{color:green}div.jsoneditor-value.jsoneditor-array,div.jsoneditor-value.jsoneditor-object{min-width:16px;color:grey}div.jsoneditor-value.jsoneditor-number{color:#ee422e}div.jsoneditor-value.jsoneditor-boolean{color:#ff8c00}div.jsoneditor-value.jsoneditor-null{color:#004ED0}div.jsoneditor-value.jsoneditor-invalid{color:#000}div.jsoneditor-tree button{width:24px;height:24px;padding:0;margin:0;border:none;cursor:pointer;background:url(../bower_components/jsoneditor/dist/img/jsoneditor-icons.svg)}div.jsoneditor-mode-form tr.jsoneditor-expandable td.jsoneditor-tree,div.jsoneditor-mode-view tr.jsoneditor-expandable td.jsoneditor-tree{cursor:pointer}div.jsoneditor-tree button.jsoneditor-collapsed{background-position:0 -48px}div.jsoneditor-tree button.jsoneditor-expanded{background-position:0 -72px}div.jsoneditor-tree button.jsoneditor-contextmenu{background-position:-48px -72px}div.jsoneditor-tree button.jsoneditor-contextmenu.jsoneditor-selected,div.jsoneditor-tree button.jsoneditor-contextmenu:focus,div.jsoneditor-tree button.jsoneditor-contextmenu:hover,tr.jsoneditor-selected.jsoneditor-first button.jsoneditor-contextmenu{background-position:-48px -48px}div.jsoneditor-tree :focus{outline:0}div.jsoneditor-tree button:focus{background-color:#f5f5f5;outline:#e5e5e5 solid 1px}div.jsoneditor-tree button.jsoneditor-invisible{visibility:hidden;background:0 0}div.jsoneditor{color:#1A1A1A;border:1px solid #3883fa;box-sizing:border-box;width:100%;height:100%;overflow:hidden;position:relative;padding:0;line-height:100%}div.jsoneditor-tree table.jsoneditor-tree{border-collapse:collapse;border-spacing:0;width:100%;margin:0}div.jsoneditor-outer{width:100%;height:100%;margin:-35px 0 0;padding:35px 0 0;box-sizing:border-box}.ace-jsoneditor,textarea.jsoneditor-text{min-height:150px}div.jsoneditor-tree{width:100%;height:100%;position:relative;overflow:auto}textarea.jsoneditor-text{width:100%;height:100%;margin:0;-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box;outline-width:0;border:none;background-color:#fff;resize:none}tr.jsoneditor-highlight,tr.jsoneditor-selected{background-color:#e6e6e6}tr.jsoneditor-selected button.jsoneditor-contextmenu,tr.jsoneditor-selected button.jsoneditor-dragarea{visibility:hidden}tr.jsoneditor-selected.jsoneditor-first button.jsoneditor-contextmenu,tr.jsoneditor-selected.jsoneditor-first button.jsoneditor-dragarea{visibility:visible}div.jsoneditor-tree button.jsoneditor-dragarea{background:url(../bower_components/jsoneditor/dist/img/jsoneditor-icons.svg) -72px -72px;cursor:move}div.jsoneditor-tree button.jsoneditor-dragarea:focus,div.jsoneditor-tree button.jsoneditor-dragarea:hover,tr.jsoneditor-selected.jsoneditor-first button.jsoneditor-dragarea{background-position:-72px -48px}div.jsoneditor td,div.jsoneditor th,div.jsoneditor tr{padding:0;margin:0}div.jsoneditor td,div.jsoneditor td.jsoneditor-tree{vertical-align:top}.jsoneditor-schema-error,div.jsoneditor td,div.jsoneditor textarea,div.jsoneditor th,div.jsoneditor-field,div.jsoneditor-value{font-family:droid sans mono,consolas,monospace,courier new,courier,sans-serif;font-size:10pt;color:#1A1A1A}.jsoneditor-schema-error{cursor:default;display:inline-block;height:24px;line-height:24px;position:relative;text-align:center;width:24px}div.jsoneditor-tree .jsoneditor-schema-error{width:24px;height:24px;padding:0;margin:0 4px 0 0;background:url(../bower_components/jsoneditor/dist/img/jsoneditor-icons.svg) -168px -48px}.jsoneditor-schema-error .jsoneditor-popover{background-color:#4c4c4c;border-radius:3px;box-shadow:0 0 5px rgba(0,0,0,.4);color:#fff;display:none;padding:7px 10px;position:absolute;width:200px;z-index:4}.jsoneditor-schema-error .jsoneditor-popover.jsoneditor-above{bottom:32px;left:-98px}.jsoneditor-schema-error .jsoneditor-popover.jsoneditor-below{top:32px;left:-98px}.jsoneditor-schema-error .jsoneditor-popover.jsoneditor-left{top:-7px;right:32px}.jsoneditor-schema-error .jsoneditor-popover.jsoneditor-right{top:-7px;left:32px}.jsoneditor-schema-error .jsoneditor-popover:before{border-right:7px solid transparent;border-left:7px solid transparent;content:'';display:block;left:50%;margin-left:-7px;position:absolute}.jsoneditor-schema-error .jsoneditor-popover.jsoneditor-above:before{border-top:7px solid #4c4c4c;bottom:-7px}.jsoneditor-schema-error .jsoneditor-popover.jsoneditor-below:before{border-bottom:7px solid #4c4c4c;top:-7px}.jsoneditor-schema-error .jsoneditor-popover.jsoneditor-left:before,.jsoneditor-schema-error .jsoneditor-popover.jsoneditor-right:before{border-top:7px solid transparent;border-bottom:7px solid transparent;content:'';top:19px;margin-left:inherit;margin-top:-7px;position:absolute}.jsoneditor-schema-error .jsoneditor-popover.jsoneditor-left:before{border-left:7px solid #4c4c4c;right:-14px;left:inherit}.jsoneditor-schema-error .jsoneditor-popover.jsoneditor-right:before{border-right:7px solid #4c4c4c;left:-14px}.jsoneditor-schema-error:focus .jsoneditor-popover,.jsoneditor-schema-error:hover .jsoneditor-popover{display:block;-webkit-animation:fade-in .3s linear 1,move-up .3s linear 1;-moz-animation:fade-in .3s linear 1,move-up .3s linear 1;-ms-animation:fade-in .3s linear 1,move-up .3s linear 1}@-webkit-keyframes fade-in{from{opacity:0}to{opacity:1}}@-moz-keyframes fade-in{from{opacity:0}to{opacity:1}}@-ms-keyframes fade-in{from{opacity:0}to{opacity:1}}.jsoneditor .jsoneditor-text-errors{width:100%;border-collapse:collapse;background-color:#ffef8b;border-top:1px solid gold}.jsoneditor .jsoneditor-text-errors td{padding:3px 6px;vertical-align:middle}.jsoneditor-text-errors .jsoneditor-schema-error{border:none;width:24px;height:24px;padding:0;margin:0 4px 0 0;background:url(../bower_components/jsoneditor/dist/img/jsoneditor-icons.svg) -168px -48px}div.jsoneditor-contextmenu-root{position:relative;width:0;height:0}div.jsoneditor-contextmenu{position:absolute;box-sizing:content-box;z-index:99999}div.jsoneditor-contextmenu li,div.jsoneditor-contextmenu ul{box-sizing:content-box}div.jsoneditor-contextmenu ul{position:relative;left:0;top:0;width:124px;background:#fff;border:1px solid #d3d3d3;box-shadow:2px 2px 12px rgba(128,128,128,.3);list-style:none;margin:0;padding:0}div.jsoneditor-contextmenu ul li button{padding:0;margin:0;width:124px;height:24px;border:none;cursor:pointer;color:#4d4d4d;background:0 0;font-size:10pt;font-family:arial,sans-serif;box-sizing:border-box;line-height:26px;text-align:left}div.jsoneditor-contextmenu ul li button::-moz-focus-inner{padding:0;border:0}div.jsoneditor-contextmenu ul li button:focus,div.jsoneditor-contextmenu ul li button:hover{color:#1a1a1a;background-color:#f5f5f5;outline:0}div.jsoneditor-contextmenu ul li button.jsoneditor-default{width:92px}div.jsoneditor-contextmenu ul li button.jsoneditor-expand{float:right;width:32px;height:24px;border-left:1px solid #e5e5e5}div.jsoneditor-contextmenu div.jsoneditor-icon{float:left;width:24px;height:24px;border:none;padding:0;margin:0;background-image:url(../bower_components/jsoneditor/dist/img/jsoneditor-icons.svg)}div.jsoneditor-contextmenu ul li button div.jsoneditor-expand{float:right;width:24px;height:24px;padding:0;margin:0 4px 0 0;background:url(../bower_components/jsoneditor/dist/img/jsoneditor-icons.svg) 0 -72px;opacity:.4}div.jsoneditor-contextmenu ul li button.jsoneditor-expand:focus div.jsoneditor-expand,div.jsoneditor-contextmenu ul li button.jsoneditor-expand:hover div.jsoneditor-expand,div.jsoneditor-contextmenu ul li button:focus div.jsoneditor-expand,div.jsoneditor-contextmenu ul li button:hover div.jsoneditor-expand,div.jsoneditor-contextmenu ul li.jsoneditor-selected div.jsoneditor-expand{opacity:1}div.jsoneditor-contextmenu div.jsoneditor-separator{height:0;border-top:1px solid #e5e5e5;padding-top:5px;margin-top:5px}div.jsoneditor-contextmenu button.jsoneditor-remove>div.jsoneditor-icon{background-position:-24px -24px}div.jsoneditor-contextmenu button.jsoneditor-remove:focus>div.jsoneditor-icon,div.jsoneditor-contextmenu button.jsoneditor-remove:hover>div.jsoneditor-icon{background-position:-24px 0}div.jsoneditor-contextmenu button.jsoneditor-append>div.jsoneditor-icon{background-position:0 -24px}div.jsoneditor-contextmenu button.jsoneditor-append:focus>div.jsoneditor-icon,div.jsoneditor-contextmenu button.jsoneditor-append:hover>div.jsoneditor-icon{background-position:0 0}div.jsoneditor-contextmenu button.jsoneditor-insert>div.jsoneditor-icon{background-position:0 -24px}div.jsoneditor-contextmenu button.jsoneditor-insert:focus>div.jsoneditor-icon,div.jsoneditor-contextmenu button.jsoneditor-insert:hover>div.jsoneditor-icon{background-position:0 0}div.jsoneditor-contextmenu button.jsoneditor-duplicate>div.jsoneditor-icon{background-position:-48px -24px}div.jsoneditor-contextmenu button.jsoneditor-duplicate:focus>div.jsoneditor-icon,div.jsoneditor-contextmenu button.jsoneditor-duplicate:hover>div.jsoneditor-icon{background-position:-48px 0}div.jsoneditor-contextmenu button.jsoneditor-sort-asc>div.jsoneditor-icon{background-position:-168px -24px}div.jsoneditor-contextmenu button.jsoneditor-sort-asc:focus>div.jsoneditor-icon,div.jsoneditor-contextmenu button.jsoneditor-sort-asc:hover>div.jsoneditor-icon{background-position:-168px 0}div.jsoneditor-contextmenu button.jsoneditor-sort-desc>div.jsoneditor-icon{background-position:-192px -24px}div.jsoneditor-contextmenu button.jsoneditor-sort-desc:focus>div.jsoneditor-icon,div.jsoneditor-contextmenu button.jsoneditor-sort-desc:hover>div.jsoneditor-icon{background-position:-192px 0}div.jsoneditor-contextmenu ul li button.jsoneditor-selected,div.jsoneditor-contextmenu ul li button.jsoneditor-selected:focus,div.jsoneditor-contextmenu ul li button.jsoneditor-selected:hover{color:#fff;background-color:#ee422e}div.jsoneditor-contextmenu ul li{overflow:hidden}div.jsoneditor-contextmenu ul li ul{display:none;position:relative;left:-10px;top:0;border:none;box-shadow:inset 0 0 10px rgba(128,128,128,.5);padding:0 10px;-webkit-transition:all .3s ease-out;-moz-transition:all .3s ease-out;-o-transition:all .3s ease-out;transition:all .3s ease-out}div.jsoneditor-contextmenu ul li ul li button{padding-left:24px;animation:all ease-in-out 1s}div.jsoneditor-contextmenu ul li ul li button:focus,div.jsoneditor-contextmenu ul li ul li button:hover{background-color:#f5f5f5}div.jsoneditor-contextmenu button.jsoneditor-type-string>div.jsoneditor-icon{background-position:-144px -24px}div.jsoneditor-contextmenu button.jsoneditor-type-string.jsoneditor-selected>div.jsoneditor-icon,div.jsoneditor-contextmenu button.jsoneditor-type-string:focus>div.jsoneditor-icon,div.jsoneditor-contextmenu button.jsoneditor-type-string:hover>div.jsoneditor-icon{background-position:-144px 0}div.jsoneditor-contextmenu button.jsoneditor-type-auto>div.jsoneditor-icon{background-position:-120px -24px}div.jsoneditor-contextmenu button.jsoneditor-type-auto.jsoneditor-selected>div.jsoneditor-icon,div.jsoneditor-contextmenu button.jsoneditor-type-auto:focus>div.jsoneditor-icon,div.jsoneditor-contextmenu button.jsoneditor-type-auto:hover>div.jsoneditor-icon{background-position:-120px 0}div.jsoneditor-contextmenu button.jsoneditor-type-object>div.jsoneditor-icon{background-position:-72px -24px}div.jsoneditor-contextmenu button.jsoneditor-type-object.jsoneditor-selected>div.jsoneditor-icon,div.jsoneditor-contextmenu button.jsoneditor-type-object:focus>div.jsoneditor-icon,div.jsoneditor-contextmenu button.jsoneditor-type-object:hover>div.jsoneditor-icon{background-position:-72px 0}div.jsoneditor-contextmenu button.jsoneditor-type-array>div.jsoneditor-icon{background-position:-96px -24px}div.jsoneditor-contextmenu button.jsoneditor-type-array.jsoneditor-selected>div.jsoneditor-icon,div.jsoneditor-contextmenu button.jsoneditor-type-array:focus>div.jsoneditor-icon,div.jsoneditor-contextmenu button.jsoneditor-type-array:hover>div.jsoneditor-icon{background-position:-96px 0}div.jsoneditor-contextmenu button.jsoneditor-type-modes>div.jsoneditor-icon{background-image:none;width:6px}div.jsoneditor-menu{width:100%;height:35px;padding:2px;margin:0;-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box;color:#fff;background-color:#3883fa;border-bottom:1px solid #3883fa}div.jsoneditor-menu>button,div.jsoneditor-menu>div.jsoneditor-modes>button{width:26px;height:26px;margin:2px;padding:0;border-radius:2px;border:1px solid transparent;background:url(../bower_components/jsoneditor/dist/img/jsoneditor-icons.svg);color:#fff;opacity:.8;font-family:arial,sans-serif;font-size:10pt;float:left}div.jsoneditor-menu>button:hover,div.jsoneditor-menu>div.jsoneditor-modes>button:hover{background-color:rgba(255,255,255,.2);border:1px solid rgba(255,255,255,.4)}div.jsoneditor-menu>button:active,div.jsoneditor-menu>button:focus,div.jsoneditor-menu>div.jsoneditor-modes>button:active,div.jsoneditor-menu>div.jsoneditor-modes>button:focus{background-color:rgba(255,255,255,.3)}div.jsoneditor-menu>button:disabled,div.jsoneditor-menu>div.jsoneditor-modes>button:disabled{opacity:.5}div.jsoneditor-menu>button.jsoneditor-collapse-all{background-position:0 -96px}div.jsoneditor-menu>button.jsoneditor-expand-all{background-position:0 -120px}div.jsoneditor-menu>button.jsoneditor-undo{background-position:-24px -96px}div.jsoneditor-menu>button.jsoneditor-undo:disabled{background-position:-24px -120px}div.jsoneditor-menu>button.jsoneditor-redo{background-position:-48px -96px}div.jsoneditor-menu>button.jsoneditor-redo:disabled{background-position:-48px -120px}div.jsoneditor-menu>button.jsoneditor-compact{background-position:-72px -96px}div.jsoneditor-menu>button.jsoneditor-format{background-position:-72px -120px}div.jsoneditor-menu>div.jsoneditor-modes{display:inline-block;float:left}div.jsoneditor-menu>div.jsoneditor-modes>button{background-image:none;width:auto;padding-left:6px;padding-right:6px}div.jsoneditor-menu>button.jsoneditor-separator,div.jsoneditor-menu>div.jsoneditor-modes>button.jsoneditor-separator{margin-left:10px}div.jsoneditor-menu a{font-family:arial,sans-serif;font-size:10pt;color:#fff;opacity:.8;vertical-align:middle}div.jsoneditor-menu a:hover{opacity:1}div.jsoneditor-menu a.jsoneditor-poweredBy{font-size:8pt;position:absolute;right:0;top:0;padding:10px}table.jsoneditor-search div.jsoneditor-results,table.jsoneditor-search input{font-family:arial,sans-serif;font-size:10pt;color:#1A1A1A;background:0 0}table.jsoneditor-search div.jsoneditor-results{color:#fff;padding-right:5px;line-height:24px}table.jsoneditor-search{position:absolute;right:4px;top:4px;border-collapse:collapse;border-spacing:0}table.jsoneditor-search div.jsoneditor-frame{border:1px solid transparent;background-color:#fff;padding:0 2px;margin:0}table.jsoneditor-search div.jsoneditor-frame table{border-collapse:collapse}table.jsoneditor-search input{width:120px;border:none;outline:0;margin:1px;line-height:20px}table.jsoneditor-search button{width:16px;height:24px;padding:0;margin:0;border:none;background:url(../bower_components/jsoneditor/dist/img/jsoneditor-icons.svg);vertical-align:top}table.jsoneditor-search button:hover{background-color:transparent}table.jsoneditor-search button.jsoneditor-refresh{width:18px;background-position:-99px -73px}table.jsoneditor-search button.jsoneditor-next{cursor:pointer;background-position:-124px -73px}table.jsoneditor-search button.jsoneditor-next:hover{background-position:-124px -49px}table.jsoneditor-search button.jsoneditor-previous{cursor:pointer;background-position:-148px -73px;margin-right:2px}table.jsoneditor-search button.jsoneditor-previous:hover{background-position:-148px -49px}

      .drawer-button {
        margin: 1em;
      }

      #headerToolbar {
        padding-left: 1.5em;
      }

      app-toolbar {
        padding: 0;
        
      }
      
      app-header {
        background-color: rgba(255,255,255,0.9);
      }

      paper-button.custom, paper-fab.custom {
        background: rgba(255,0,0,0.8);
        
        margin: 0.5em;
        display: inline-block;
      }

      paper-button.adm_drwr{
        display: inline-block;
      }
      paper-button.adm_drwr:hover {
        background: rgba(255,0,0,0.8);
        color: white;
      }
      
      paper-fab.custom {
        font-size:1.5em;
        line-height: 1em;
      }

      paper-button.custom:hover, paper-fab.custom:hover {
        background: red;
        color: black;
      }

      .rebel-image{
        max-height: 150px;
        max-width: 150px;
      }

      .description-item {
        margin: 2em;
      }

      #jsoneditor {
        height: 100%;
        width: 100%;
      }
      ol, ul {
        list-style: none;
      }

      img.attachment {
        max-height: 175px;
        max-width: 175px;
        padding-top: 55px;
      }

      .current-page {
        width: 1em;
        height: 100%;
        background-color: red;
      }

      @media (max-width: 767px) {
        
      }
    </style>

    <app-pouchdb-document
      db-name="admin"
      doc-id="admin"
      data="{{admin}}">
    </app-pouchdb-document>

    <iron-ajax
      id="ajaxValidateApiKey"
      url="http://localhost:3000/api/validate_api_key"
      headers='{{headers}}'
      handle-as="json"
      on-response="_handleValidateApiKeyResponse">
    </iron-ajax>

    
    <iron-ajax
      id="ajaxFetchQuote"
      url="http://localhost:3000/api/quote"
      headers='{{headers}}'
      handle-as="json"
      on-response="_handleFetchQuoteResponse"
      last-response="{{quote}}"
      debounce-duration="500">
    </iron-ajax>

    <iron-ajax
      id="ajaxGetHomePage"
      url="http://localhost:3000/api/pages"
      params='{"page":"home"}'
      headers='{{headers}}'
      handle-as="json"
      last-response="{{homePage}}">
    </iron-ajax>

    <iron-ajax
      id="ajaxGetAboutPage"
      url="http://localhost:3000/api/pages"
      params='{"page":"about"}'
      headers='{{headers}}'
      handle-as="json"
      last-response="{{aboutPage}}">
    </iron-ajax>

    <iron-ajax
      id="ajaxGetServicesPage"
      url="http://localhost:3000/api/pages"
      params='{"page":"services"}'
      headers='{{headers}}'
      handle-as="json"
      last-response="{{servicesPage}}">
    </iron-ajax>

    <iron-ajax
      id="ajaxUpdatePage"
      url="http://localhost:3000/api/pages"
      method="POST"
      headers='{{headers}}'
      handle-as="json"
      content-type="application/json"
      on-response="_handleUpdatePageResponse">
    </iron-ajax>

    <iron-ajax
      id="ajaxGetImages"
      url="http://localhost:3000/api/images"
      headers='{{headers}}'
      handle-as="json"
      last-response="{{images}}">
    </iron-ajax>

    <iron-ajax
      id="ajaxCreateImage"
      url="http://localhost:3000/api/create_image"
      method="POST"
      headers='{{headers}}'
      on-response="_handleAjaxCreateImagePostResponse"
      on-error="_handleAjaxCreateImagePostError"
      >
    </iron-ajax>

    <iron-ajax
      auto
      url="http://localhost:3000/api/rebelvendor/companycasuals.json"
      handle-as="json"
      on-response="_handleProductsResponse"
      debounce-duration="500"
      last-response="{{companycasuals}}">
    </iron-ajax>

    <app-drawer-layout fullbleed>

      <app-drawer>
        <div style="height: 100%; overflow: auto;">
          <app-toolbar><span id="headerToolbar">Admin</span></app-toolbar>
          <div id="drawerButtonsContainer" hidden>
            <div class="drawer-button">
              <paper-button class="adm_drwr" on-tap="_setCurrentPage" page="Quote">Quotes</paper-button>
            </div>
            <div class="drawer-button">
              <paper-button class="adm_drwr" on-tap="_setCurrentPage" page="Vendor Goods">Vendor Goods</paper-button>
            </div>
            <div class="drawer-button">
              <paper-button class="adm_drwr" on-tap="_setCurrentPage" page="Images">Images</paper-button>
            </div>
            <div class="drawer-button">
              <paper-button class="adm_drwr" on-tap="_setCurrentPage" page="Home">Home</paper-button>
            </div>
            <div class="drawer-button">
              <paper-button class="adm_drwr" on-tap="_setCurrentPage" page="About">About</paper-button>
            </div>
            <div class="drawer-button">
              <paper-button class="adm_drwr" on-tap="_setCurrentPage" page="Services">Services</paper-button>
            </div>
            <div class="drawer-button">
              <paper-button class="adm_drwr" on-tap="_setCurrentPage" page="Api Key">Api Key</paper-button>
            </div>
          </div>
        </div>
      </app-drawer>
      
      <app-header-layout>

        <app-header condenses reveals effects="waterfall">
          <app-toolbar>
              <paper-icon-button icon="menu" drawer-toggle></paper-icon-button>
          </app-toolbar>
          <app-toolbar>
            <div main-title>
              <h4>[[currentPage]]</h4>
              <template is="dom-if" if="[[_isServices(currentPage)]]">
                ([[servicesPage.items.length]])
              </template>
            </div>
            <template is="dom-if" if="[[isPages]]">
              <paper-button class="custom" on-tap="_savePage">Save Page</paper-button>
            </template>
          </app-toolbar>
        </app-header>

      </app-header-layout>

      <div id="apiKeyContainer" hidden>
        <div class="row">
          <div class="col s12 m8 offset-m2">
            <paper-input label="Api Key" value="{{admin.apiKey}}"></paper-input>
          </div>

        </div>
      </div>

      <div id="quotesContainer" hidden>
        <div class="row">
          <div class="col s12 m8 offset-m2">
            <paper-input label="Quote Number" value="{{admin.quoteID}}"></paper-input>
          </div>

        </div>

        <!-- <rebelcricket-quote quote="[[quote]]" quote-id="[[quoteID]]"></rebelcricket-quote> -->
      </div>

      <div id="vendorGoodsContainer" hidden>
        <div id="jsoneditor"></div>
      </div>

      <div id="homePageContainer" hidden>

        
        <template is="dom-if" if="[[homePage.attachments]]">
          <div class="row">
            <div class="s12">
              <h5>Image Carousel</h5>
            </div>
          </div>

          <template is="dom-repeat" items="{{homePage.attachments}}">
            <div class="row">
              <div class="col s4">
                <img src="[[item.url]]" class="attachment">
              </div>
              <div class="col s6">
                <ul>
                <li><paper-input label="Caption" value="{{item.caption}}"></paper-input></li>
                <li><paper-input label="Link To" value="{{item.link_to}}"></paper-input></li>
                <li><paper-input label="URL" value="{{item.url}}"></paper-input></li>
                <li>
                <paper-fab mini on-tap="_removeHomePageAttachment" class="custom" label="&nbsp;&times;"></paper-fab>
                </li>
                </ul>
              </div>
            </div>
          </template>
          
          <div class="row">
            <div class="col s12 center">
              <paper-button class="custom" on-tap="_addHomePageAttachment">Add Another Image</paper-button>
            </div>
          </div>
        </template>
      </div>

      <div id="aboutPageContainer" hidden>
        
        <div class="row">
          <div class="col s12 m8 offset-m2">
            <paper-input label="Heading" value="{{aboutPage.heading}}"></paper-input>
          </div>

          <template is="dom-if" if="[[aboutPage.items]]">
            <div class="col s12 m8 offset-m2">
              <h5>Items</h5>
            </div>

            <template id="pageDataItems" is="dom-repeat" items="{{aboutPage.items}}">

              <div class="col s12 m8 offset-m2">
                <paper-input label="Title" value="{{item.title}}"></paper-input>
                <paper-textarea label="Description" value="{{item.description}}"></paper-textarea>
              </div>

              <div class="col s12 m8 offset-m2">
                <paper-fab mini on-tap="_removeAboutPageDescriptionItem" class="custom" label="&nbsp;&times;"></paper-fab>
              </div>
             
            </template>

            <div class="row description-item">
              <div class="col s12 m8 offset-m2">
                <paper-button class="custom" on-tap="_addAboutPageDescriptionItem">Add Description Item</paper-button>
              </div>
            </div>
    
          </template>
        </div>
      </div>

      <div id="servicesPageContainer" hidden>
     
        <div class="row">
          <div class="col s12 m8 offset-m2">
            <paper-input label="Heading" value="{{servicesPage.heading}}"></paper-input>
          </div>

          <div class="col s12 m8 offset-m2">
            <h5>Items</h5>
          </div>
          <template id="pageDataItems" is="dom-repeat" items="{{servicesPage.items}}">

            <div class="col s12 m8 offset-m2">
              <paper-input label="Name" value="{{item.name}}"></paper-input>
            </div>
            <div class="col s12 m8 offset-m2">
              <paper-input label="Slug" value="{{item.slug}}"></paper-input>
            </div>

            <div class="col s12 m8 offset-m2">
              <h6>Main Image</h6>
            </div>
            <div class="col s12 m8 offset-m2">
              <ul>
              <li><paper-input label="URL" value="{{item.image}}"></paper-input></li>
              </ul>
            </div>
      

            <div class="col s12 m8 offset-m2">
              <h6>Detail Images</h6>
            </div>
            <div class="col s12 m8 offset-m2">
              <ul>
                <template is="dom-repeat" items="{{item.detail_images}}" as="detailImageItem">
                  <li>
                    <paper-input label="URL" value="{{detailImageItem}}"></paper-input>
                    <paper-fab mini on-tap="_removeServicesDetailImage" class="custom" label="&nbsp;&times;" idx$="[[_servicePageItemIndex(item)]]"></paper-fab>
                  </li>
                </template>
                <li><paper-button class="custom" on-tap="_addServicesDetailImage">Add Detail Image</paper-button></li>
              </ul>
            </div>
             
            <template is="dom-repeat" items="{{item.detail_items}}" as="descriptionItem">
              <div class="col s12 m8 offset-m2">
                <paper-input label="Heading" value="{{descriptionItem.name}}"></paper-input>

                <paper-textarea label="Description Item" value="{{descriptionItem.description}}"></paper-textarea>
                  
              </div>

              <div class="col s12 m8 offset-m2">
                <paper-fab mini on-tap="_removeServicesDescriptionItem" class="custom" label="&nbsp;&times;"></paper-fab>
              </div>
            </template>

              

            <div class="row description-item">
              <div class="col s12 m8 offset-m2">
                <paper-button class="custom" on-tap="_addServicesDescriptionItem">Add Description Item</paper-button>
              </div>
            </div>

            <div class="row description-item">
              <div class="col s12 m8 offset-m2">
                <paper-button class="custom" on-tap="_removeService">Remove [[item.name]] Service</paper-button>
              </div>
            </div>
            
            <hr>
            
          </template>


          <div class="row">
            <div class="col s12 center">
              <paper-button class="custom" on-tap="_addService">Add Service</paper-button>
            </div>
          </div>


        </div>

      </div>      

      <div id="imagesContainer" hidden>
        <div class="row">
          <div class="col s12 m6 offset-m3">
            <br><br><br>
            <label for="rebelImages">&nbsp;Upload Image file</label>
            <input id="rebelImages" type="file"></input>

            <paper-spinner id="rebelImagesSpinner" alt="Uploading File..."></paper-spinner>
            <span id="rebelImagesFeedback"></span>
          </div>
        </div>
        <div class="row">
          <div class="col s12">
            <template is="dom-repeat" items="{{images}}">
              <img class="rebel-image" src$="[[item.url]]">
            </template>
          </div>
        </div>

      </div>

    </app-drawer-layout>
   
  </template>

  <script>

    Polymer({

      is: 'rebelcricket-admin',
      properties: {
        admin: {
          type: Object,
          notify: true,
          observer: '_adminObserver'
        },
        apiKey: {
          type: String,
          notify: true,
          value: function(){
            return '';
          }
        },
        quoteID: {
          type: String,
          notify: true,
          value: function() { 
            return window.location.hash.replace(/#/,'');
          }
        },
        quote: {
          type: Object,
          notify: true
        },
        headers: {
          type: Object,
          computed: '_header(apiKey)'
        },
        hasValidApiKey: {
          type: Boolean,
          notify: true,
          computed: '_validateApiKey(apiKey)'
        },
        homePage: {
          type: Object,
          notify: true
        },
        aboutPage: {
          type: Object,
          notify: true
        },
        servicesPage: {
          type: Object,
          notify: true
        },
        isPages: {
          type: Boolean,
          notify: true
        },
        currentPage: {
          type: String,
          notify: true,
          observer: '_currentPageChanged',
          value: function(){
            return 'Api Key';
          }
        },
        images: {
          type: Array,
          notify: true
        },
        companycasuals: {
          type: Object,
          notify: true
        }
      },
      _header: function(_apiKey) {
        // console.log('_header _apiKey:',_apiKey);
        return {'Authorization': 'Token token="'+_apiKey+'"'};
      },
      _adminObserver: function(admin){
        if(admin.apiKey != undefined && admin.apiKey != ''){
          // console.log('api key from pouch:',admin.apiKey);
          if(this.apiKey != admin.apiKey){
            this._validateApiKey(admin.apiKey);
          }
        }
        if(admin.quoteID != undefined && admin.quoteID != ''){
          if(this.quoteID != admin.quoteID){
            this._fetchQuote(admin.quoteID);
          }
        }
      },
      _currentPageChanged: function(_currentPage){
        if(_currentPage === 'Api Key'){
          this.$.apiKeyContainer.hidden = false;
          this.$.quotesContainer.hidden = true;
          this.$.vendorGoodsContainer.hidden = true;
          this.$.homePageContainer.hidden = true;
          this.$.aboutPageContainer.hidden = true;
          this.$.servicesPageContainer.hidden = true;
          this.$.imagesContainer.hidden = true;
          this.set('isPages', false);
        }else if(_currentPage === 'Quote'){

          if(this.$$('rebelcricket-quote') == undefined){
            this.importHref('src/rebelcricket-quote.html', function(e) {
              // e.target.import is the import document.
              var quoteElem = document.createElement('rebelcricket-quote');
              // console.log('GONNA SET quoteID:',this.admin.quoteID);
              quoteElem.quoteID = this.admin.quoteID;
              quoteElem.quote = this.quote;
              Polymer.dom(this.$.quotesContainer).appendChild(quoteElem);  
            }, function(e) {
              // loading error
            });
          }

          this.$.apiKeyContainer.hidden = true;
          this.$.quotesContainer.hidden = false;
          this.$.vendorGoodsContainer.hidden = true;
          this.$.homePageContainer.hidden = true;
          this.$.aboutPageContainer.hidden = true;
          this.$.servicesPageContainer.hidden = true;
          this.$.imagesContainer.hidden = true;
          this.set('isPages', false);
        }else if(_currentPage === 'Vendor Goods'){

          // if(this.$$('rebelcricket-vendor') != undefined){
          //   // console.log('DONOT NEED TO IMPORT HREF FOR VENDOR!');
          // }else{
          //   // console.log('GONNA IMPORT HREF FOR VENDOR!');
          //   this.importHref('src/rebelcricket-vendor.html', function(e) {
          //     // e.target.import is the import document.
          //     var vendorElem = document.createElement('rebelcricket-vendor');
          //     // quoteElem.quoteID = this.quoteID
          //     // quoteElem.lineItem = this.lineItemForVendor; //lineItemForVendor
              
          //     Polymer.dom(this.$.vendorGoodsContainer).appendChild(vendorElem);  
          //   }, function(e) {
          //     // loading error
          //   });
          // }
          
          var container = this.$.jsoneditor;
          var options = {};
          var editor = new JSONEditor(container, options);

          // set json
          // var json = {
          //     "Array": [1, 2, 3],
          //     "Boolean": true,
          //     "Null": null,
          //     "Number": 123,
          //     "Object": {"a": "b", "c": "d"},
          //     "String": "Hello World"
          // };
          editor.set(this.companycasuals);

          // get json
          var json = editor.get();

          this.$.apiKeyContainer.hidden = true;
          this.$.quotesContainer.hidden = true;
          this.$.vendorGoodsContainer.hidden = false;
          this.$.homePageContainer.hidden = true;
          this.$.aboutPageContainer.hidden = true;
          this.$.servicesPageContainer.hidden = true;
          this.$.imagesContainer.hidden = true;
          this.set('isPages', false);
        }else if(_currentPage === 'Home'){
          this.$.ajaxGetHomePage.generateRequest();
          this.$.apiKeyContainer.hidden = true;
          this.$.quotesContainer.hidden = true;
          this.$.vendorGoodsContainer.hidden = true;
          this.$.homePageContainer.hidden = false;
          this.$.aboutPageContainer.hidden = true;
          this.$.servicesPageContainer.hidden = true;
          this.$.imagesContainer.hidden = true;
          this.set('isPages', false);
        }else if(_currentPage === 'About'){
          this.$.ajaxGetAboutPage.generateRequest();
          this.$.apiKeyContainer.hidden = true;
          this.$.quotesContainer.hidden = true;
          this.$.vendorGoodsContainer.hidden = true;
          this.$.homePageContainer.hidden = true;
          this.$.aboutPageContainer.hidden = false;
          this.$.servicesPageContainer.hidden = true;
          this.$.imagesContainer.hidden = true;
          this.set('isPages', true);
        }else if(_currentPage === 'Services'){
          this.$.ajaxGetServicesPage.generateRequest();
          this.$.apiKeyContainer.hidden = true;
          this.$.quotesContainer.hidden = true;
          this.$.vendorGoodsContainer.hidden = true;
          this.$.homePageContainer.hidden = true;
          this.$.aboutPageContainer.hidden = true;
          this.$.servicesPageContainer.hidden = false;
          this.$.imagesContainer.hidden = true;
          this.set('isPages', true);
        }else if(_currentPage === 'Images'){
          this.$.ajaxGetImages.generateRequest();
          this.$.apiKeyContainer.hidden = true;
          this.$.quotesContainer.hidden = true;
          this.$.vendorGoodsContainer.hidden = true;
          this.$.homePageContainer.hidden = true;
          this.$.aboutPageContainer.hidden = true;
          this.$.servicesPageContainer.hidden = true;
          this.$.imagesContainer.hidden = false;
          this.set('isPages', false);
        }
      },
      _setCurrentPage: function(e){
        // console.log('_setCurrentPage e.target.getAttribute(page):',e.target.getAttribute('page'));
        this.set('currentPage', e.target.getAttribute('page'));
      },
      _validateApiKey: function(apiKey){
        // console.log('_validateApiKey: ',apiKey == undefined || apiKey == '');
        this.set('apiKey', apiKey);
        //return apiKey == undefined || apiKey == '';
        this.$.ajaxValidateApiKey.generateRequest();
      },
      _fetchQuote: function(_quoteID){
        this.set('quoteID',_quoteID);

        var params = {};
        params["quote_number"] = _quoteID;
        this.$.ajaxFetchQuote.params = params;

        this.$.ajaxFetchQuote.generateRequest();
      },
      _handleFetchQuoteResponse: function(e){
        // console.log('_handleFetchQuoteResponse e:',e);
        // console.log('this.quote:',this.quote);
        this.$$('rebelcricket-quote').quoteID = this.quoteID;
        this.$$('rebelcricket-quote').quote = e.detail.response;
      },
      _toggleDrawer: function(e){
        this.$.drawer.toggle();
      },
      _handleValidateApiKeyResponse: function(e){
        // console.log('_handleValidateApiKeyResponse e.detail.xhr.statusText:',e.detail.xhr.statusText);
        if(e.detail.xhr.statusText === 'OK'){
          this.$.drawerButtonsContainer.hidden = false;
          this.set('currentPage', 'Home');
        }
      },
      _handleUpdatePageResponse: function(e){
         // console.log('_handleUpdatePageResponse e.detail.xhr.statusText:',e.detail.xhr.statusText);
      },
      _handleAjaxCreateImagePostResponse: function(e){
        // console.log('_handleAjaxCreateImagePostResponse e:',e);
        this.$.rebelImagesSpinner.active = false;
        this.$.ajaxGetImages.generateRequest();
      },
      _handleAjaxCreateImagePostError: function(e){
        // console.log('_handleAjaxCreateImagePostError e:',e);
        this.$.rebelImagesSpinner.active = false;
      },
      _savePage: function(e){
        // console.log('_savePages e:',e);

        var params = {};
        
        if(this.currentPage == 'Home'){
          params["page"] = 'home';
          this.$.ajaxUpdatePage.body = {data: this.homePage};
        }else if(this.currentPage == 'About'){
          params["page"] = 'about';
          this.$.ajaxUpdatePage.body = {data: this.aboutPage};
        }else if(this.currentPage == 'Services'){
          params["page"] = 'services';
          // params["data"] = ; 
          this.$.ajaxUpdatePage.body = {data: this.servicesPage};
        }

        this.$.ajaxUpdatePage.params = params;
        this.$.ajaxUpdatePage.generateRequest();
      },
      _addHomePageAttachment: function(e){
        this.push('homePage.attachments',{caption: '', link_to: '', url: ''});
      },
      _removeHomePageAttachment: function(e){
        this.splice('homePage.attachments', e.model.index, 1);
      },
      _addService: function(e){
        // console.log('_addService');
        this.push('servicesPage.items', {image: '', name: '', slug:'', detail_images: [], detail_items: []});
      },
      _removeService: function(e){
        // console.log('_removeService idx',e.model.index);
        this.splice('servicesPage.items', e.model.index, 1)
      },
      _addAboutPageDescriptionItem: function(e){
        this.push('aboutPage.items', {description: '', title: ''})
      },
      _removeAboutPageDescriptionItem: function(e){
        this.splice('aboutPage.items', e.model.index, 1);
      },
      _addServicesDetailImage: function(e){
        // console.log('_addDetailImage e.model.index',e.model.index,' e.model.page:',e.model.page);
        this.push('servicesPage.items.'+e.model.index+'.detail_images', '');
      },
      _removeServicesDetailImage: function(e){
        var _servicesPageIdx = e.target.getAttribute('idx');
        // console.log('_removeServicesDetailImage idx attr?',_servicesPageIdx);
        this.splice('servicesPage.items.'+_servicesPageIdx+'.detail_images', e.model.index, 1);
      },
      _addServicesDescriptionItem: function(e){
        // console.log('_addServicesDescriptionItem: e.model.index',e.model.index);
        this.push('servicesPage.items.'+e.model.index+'.detail_items', {description: '', name: ''});
      },
      _removeServicesDescriptionItem: function(e){
        // console.log('_removeServicesDescriptionItem: this.servicesPage.items.indexOf(e.model.item):',this.servicesPage.items.indexOf(e.model.item));
        this.splice('servicesPage.items.'+this.servicesPage.items.indexOf(e.model.item)+'.detail_items',e.model.index, 1);
      },
      _isServices: function(_pageName){
        return _pageName == 'services';
      },
      _isCurrentPage: function(_pageName){
        return this.currentPage == _pageName ? 'current-page' : '';
      },
      _servicePageItemIndex: function(_item){
        return this.servicesPage.items.indexOf(_item);
      },
      ready: function(){

        if(window.location.hash.replace(/#/,'').length > 5){
          // console.log('lookz like we have a quoteID! ',window.location.hash.replace(/#/,''));
          this.async(function(){
            this.set('quoteID', '');
            this.set('admin.quoteID', window.location.hash.replace(/#/,''));
          }, 200);
          
        }
        //file upload
        var input = this.$.rebelImages;
        var _this = this;
        input.addEventListener('change', function () {
          var file = input.files[0]; // file is a Blob

          _this.$.rebelImagesSpinner.active = true;

          var params = {};
          params["filename"] = file.name;
          _this.$.ajaxCreateImage.params = params;

          var formData = new FormData();
          formData.append('file', file);

          _this.$.ajaxCreateImage.body = formData;
          _this.$.ajaxCreateImage.generateRequest();


        });


      }


    });

  </script>

</dom-module>
